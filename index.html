<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Love Surprise ‚Äî For My Bestie ‚ù§Ô∏è</title>
<style>
  :root{
    --bg1:#05040a; --bg2:#0b1220; --accent:#ff4d6d; --soft:#ff9bb3; --gold:#ffd166;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial; background:var(--bg1); color:#fff; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
  /* full screen stage */
  .stage{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:18px;box-sizing:border-box;flex-direction:column;gap:18px;z-index:1}
  .card{width:100%;max-width:1060px;margin:0 auto;padding:18px;border-radius:16px;box-shadow:0 30px 80px rgba(7,8,14,0.7);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)}
  header{display:flex;justify-content:space-between;align-items:center;gap:12px}
  h1{margin:0;font-size:20px;letter-spacing:0.4px}
  p.desc{margin:4px 0 0 0;font-size:13px;color:rgba(255,255,255,0.75)}
  .playBtn{background:linear-gradient(90deg,var(--accent),#ff7a88);border:none;padding:12px 20px;border-radius:999px;color:white;font-weight:700;cursor:pointer;box-shadow:0 10px 30px rgba(255,77,109,0.18);font-size:16px}
  .playBtn:active{transform:scale(.99)}

  /* starfield: many tiny dots via box-shadow trick for performance */
  .starfield{position:fixed;inset:0;z-index:-4;background:radial-gradient(ellipse at bottom, rgba(10,10,20,0.6) 0%, rgba(5,5,12,1) 60%);}
  .stars{position:absolute;inset:0;opacity:0.9;filter:contrast(120%);}
  .stars::before{
    content:"";
    position:absolute;inset:0;
    background:
      radial-gradient(2px 2px at 10% 20%, rgba(255,255,255,0.95), transparent),
      radial-gradient(1.5px 1.5px at 20% 70%, rgba(255,255,255,0.85), transparent),
      radial-gradient(1.3px 1.3px at 35% 35%, rgba(255,255,255,0.9), transparent),
      radial-gradient(1px 1px at 60% 20%, rgba(255,255,255,0.8), transparent),
      radial-gradient(1.7px 1.7px at 80% 60%, rgba(255,255,255,0.88), transparent),
      radial-gradient(1px 1px at 90% 10%, rgba(255,255,255,0.7), transparent);
    background-repeat:repeat;
    background-size: 100px 100px;
    animation: twinkle 6s linear infinite;
  }
  @keyframes twinkle{50%{opacity:.7}100%{opacity:1}}

  /* shooting star */
  .shoot{position:fixed;z-index:-3;left:-10%;top:10%;opacity:0;transform:rotate(-30deg);filter:drop-shadow(0 6px 14px rgba(255,255,255,0.08));}
  .shoot .tail{width:220px;height:2px;background:linear-gradient(90deg, rgba(255,255,255,0.95), rgba(255,255,255,0));box-shadow:0 0 18px rgba(255,255,255,0.4);}

  /* falling decorative hearts */
  .fallingLayer{position:fixed;inset:0;pointer-events:none;z-index:-2}
  .fheart{position:absolute;font-size:20px;filter:drop-shadow(0 6px 18px rgba(255,20,100,0.12));opacity:0.95;transform-origin:center}

  /* tree area */
  .tree-area{display:flex;align-items:center;justify-content:center;padding:30px 0}
  .tree-wrap{position:relative;width:720px;max-width:92vw;height:560px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:20px;display:flex;align-items:center;justify-content:center;box-shadow:inset 0 -40px 120px rgba(0,0,0,0.35);border:1px solid rgba(255,255,255,0.03)}
  svg.tree{width:86%;height:86%}

  /* trunk + branches draw animation */
  .draw { stroke:#3b2b19; stroke-width:6; fill:none; stroke-linecap:round; stroke-linejoin:round; stroke-dasharray:2000; stroke-dashoffset:2000; animation: drawLine 2.6s ease forwards; }
  .draw.delay { animation-delay:0.25s }
  @keyframes drawLine { to { stroke-dashoffset:0 } }

  /* heart nodes container (absolute) */
  .node-layer{position:absolute;inset:0;pointer-events:none}

  .node { position:absolute; pointer-events:auto; cursor:pointer; width:48px; height:48px; display:flex; align-items:center; justify-content:center; font-size:26px; background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); border-radius:50%; box-shadow:0 10px 30px rgba(255,77,109,0.12); transition: transform .22s ease, box-shadow .22s; }
  .node:hover{ transform:scale(1.08) }
  .node .h{ color:var(--accent); text-shadow:0 6px 20px rgba(255,77,109,0.18); filter: drop-shadow(0 8px 18px rgba(255,77,109,0.12)); font-size:22px; }
  .node.pulse { animation: pop 1.4s infinite; }
  @keyframes pop { 0%{transform:scale(1)}50%{transform:scale(1.08)}100%{transform:scale(1)} }

  /* question modal */
  .modal{position:fixed;left:50%;top:70%;transform:translate(-50%,-50%);width:92%;max-width:480px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));padding:16px;border-radius:12px;box-shadow:0 18px 50px rgba(0,0,0,0.6);z-index:40;border:1px solid rgba(255,255,255,0.04);display:none;}
  .q{font-weight:800;font-size:18px;margin-bottom:10px}
  .opts{display:flex;gap:12px}
  .btnOpt{flex:1;padding:12px;border-radius:10px;cursor:pointer;text-align:center;font-weight:700;border:1px solid rgba(255,255,255,0.03);background:rgba(255,255,255,0.02)}
  .btnOpt.primary{background:linear-gradient(90deg,var(--accent),#ff7a88);color:white;border:none}
  .btnOpt.dodge{position:relative;transition:all .18s ease}

  /* burning overlay */
  .burnOverlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:radial-gradient(circle at center, rgba(255,120,140,0.06), rgba(0,0,0,0.6));z-index:80}
  .burnHeart{font-size:140px;animation:burnPop 2.2s cubic-bezier(.2,.9,.2,1) forwards}
  @keyframes burnPop{0%{transform:scale(.6);opacity:1;text-shadow:0 0 28px rgba(255,90,120,0.9)}60%{transform:scale(1.1);opacity:1}100%{transform:scale(2.6);opacity:0;filter:blur(8px)}}

  /* reveal area */
  .reveal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;gap:18px;z-index:85;padding:28px}
  .revealPanel{width:100%;max-width:980px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;padding:18px;backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,0.03);display:flex;gap:18px;align-items:center;justify-content:center;flex-wrap:wrap}
  .big{width:52%;max-width:520px;border-radius:14px;box-shadow:0 30px 80px rgba(0,0,0,0.6);transform-origin:center;transition:transform .5s cubic-bezier(.2,.9,.2,1)}
  .small{width:38%;max-width:360px;border-radius:12px;display:flex;gap:12px;flex-direction:column}
  .small img, .big img{width:100%;height:auto;border-radius:12px;object-fit:cover;box-shadow:0 20px 60px rgba(0,0,0,0.45)}
  .finalLine{font-size:20px;color:var(--soft);text-shadow:0 0 28px rgba(255,0,80,0.12);font-weight:700;text-align:center}

  /* floating I ‚ù§Ô∏è U bubbles */
  .floaters{position:fixed;inset:0;pointer-events:none;z-index:86}
  .floater{position:absolute;font-size:22px;color:var(--accent);opacity:0.95;filter:drop-shadow(0 8px 16px rgba(255,20,100,0.12));animation:floatUp linear infinite}
  @keyframes floatUp{0%{transform:translateY(40px);opacity:0}20%{opacity:1}100%{transform:translateY(-140px);opacity:0}}

  /* responsive */
  @media (max-width:720px){
    .tree-wrap{height:66vh}
    .big{width:92%}
    .small{width:92%}
  }
</style>
</head>
<body>
  <!-- decorative layers -->
  <div class="starfield"><div class="stars"></div></div>
  <div class="shoot" id="shoot"><div class="tail"></div></div>
  <div class="fallingLayer" id="fallingLayer"></div>
  <div class="floaters" id="floaters"></div>

  <!-- main UI -->
  <div class="stage">
    <div class="card" role="main" aria-label="Love Surprise">
      <header>
        <div>
          <h1>For my bestie ‚ù§Ô∏è</h1>
          <p class="desc">Tap a heart on the tree and answer ‚Äî a sweet surprise will follow.</p>
        </div>
        <div>
          <button class="playBtn" id="playBtn">‚ñ∂ Play (Janemann) ‚Äî 1.5x</button>
        </div>
      </header>

      <div class="tree-area" style="margin-top:14px">
        <div class="tree-wrap" id="treeWrap">
          <!-- SVG Tree (drawn via CSS animation) -->
          <svg class="tree" viewBox="0 0 420 520" preserveAspectRatio="xMidYMid meet" aria-hidden="true">
            <!-- trunk -->
            <path class="draw delay" d="M210 500 C210 420 210 360 210 320
              C190 280 170 260 150 230
              C130 200 120 170 140 150
              C170 120 200 110 230 105
              C265 100 290 110 315 140
              C340 170 355 200 375 230
              C395 260 410 300 380 330
              C350 360 320 370 300 390" />
            <!-- branch -->
            <path class="draw" d="M210 300 C178 280 148 250 130 220" />
            <path class="draw" d="M260 240 C300 220 340 200 360 170" />
          </svg>

          <!-- Node hearts overlay (positioned by JS) -->
          <div class="node-layer" id="nodeLayer" aria-hidden="false"></div>

        </div>
      </div>
    </div>
  </div>

  <!-- modal -->
  <div class="modal" id="modal" role="dialog" aria-modal="true">
    <div class="q" id="qtxt"></div>
    <div class="opts">
      <div class="btnOpt" id="optA"></div>
      <div class="btnOpt primary" id="optB"></div>
    </div>
  </div>

  <!-- burning overlay -->
  <div class="burnOverlay" id="burnOverlay"><div class="burnHeart">‚ù§Ô∏èüî•</div></div>

  <!-- reveal area -->
  <div class="reveal" id="reveal">
    <div class="revealPanel">
      <div class="big"><img id="bigImg" src="pic2.jpg" alt="Picture" /></div>
      <div class="small">
        <img id="small1" src="pic1.jpg" alt="pic1" />
        <div class="finalLine" id="finalLine">Your beauty shines brighter than every star, my precious friend ‚ù§Ô∏è</div>
      </div>
    </div>
  </div>

  <!-- audio -->
  <audio id="audio" src="song.mp3" preload="auto"></audio>

<script>
/* ========== Setup & autoplay ========== */
const audio = document.getElementById('audio');
audio.playbackRate = 1.5;
audio.volume = 0.75;

// Try autoplay (some browsers block; fallback on first interaction)
function tryPlay(){
  audio.play().catch(()=>{/*blocked*/});
}
window.addEventListener('load', ()=> {
  tryPlay();
});
// fallback: play on any first user interaction if blocked
function enableOnFirstInteraction(){
  tryPlay();
  window.removeEventListener('click', enableOnFirstInteraction);
  window.removeEventListener('touchstart', enableOnFirstInteraction);
}
window.addEventListener('click', enableOnFirstInteraction);
window.addEventListener('touchstart', enableOnFirstInteraction);

/* ========== shooting star schedule ========== */
const shoot = document.getElementById('shoot');
function runShootingStar(){
  shoot.style.opacity = 1;
  shoot.style.left = '-15%';
  shoot.style.top = (10 + Math.random()*30) + '%';
  shoot.style.transition = 'transform 1.2s linear, left 1.2s linear, opacity .6s';
  shoot.style.transform = 'translateX(140vw) rotate(-30deg)';
  setTimeout(()=> {
    shoot.style.opacity = 0;
    shoot.style.transform = 'translateX(0)';
  },1300);
}
setInterval(()=> { if(Math.random() < 0.6) runShootingStar(); }, 6000);

/* ========== floating hearts (decor) ========== */
const fallingLayer = document.getElementById('fallingLayer');
function spawnFloatingHeart(){
  const el = document.createElement('div');
  el.className = 'fheart';
  el.innerText = '‚ù§Ô∏è';
  const size = 14 + Math.random()*28;
  el.style.fontSize = size + 'px';
  el.style.left = (5 + Math.random()*90) + 'vw';
  el.style.top = (-10 - Math.random()*6) + 'vh';
  const dur = 5 + Math.random()*6;
  el.style.transition = `transform ${dur}s linear, top ${dur}s linear, opacity ${dur}s`;
  fallingLayer.appendChild(el);
  requestAnimationFrame(()=> {
    el.style.top = (110 + Math.random()*10) + 'vh';
    el.style.transform = `translateY(${window.innerHeight}px) rotate(${Math.random()*360}deg)`;
    el.style.opacity = 0;
  });
  setTimeout(()=> el.remove(), (dur*1000)+200);
}
setInterval(spawnFloatingHeart, 650);

/* ========== Node hearts creation & exact positioning ========== */
/* Coordinates are chosen relative to the svg viewBox (420x520). We'll convert to pixel positions inside the treeWrap */
const nodeDefs = [
  {id:'n1', x:225, y:115, qIndex:0},
  {id:'n2', x:150, y:170, qIndex:1},
  {id:'n3', x:285, y:200, qIndex:2},
  {id:'n4', x:200, y:245, qIndex:3}
];
const nodeLayer = document.getElementById('nodeLayer');
function placeNodes(){
  const wrap = document.getElementById('treeWrap');
  const rect = wrap.getBoundingClientRect();
  nodeLayer.innerHTML = '';
  nodeDefs.forEach((d,i)=>{
    const el = document.createElement('div');
    el.className = 'node pulse';
    el.id = d.id;
    el.innerHTML = `<div class="h">‚ù§Ô∏è</div>`;
    // convert viewbox coords to absolute pixel within wrap
    const px = (d.x / 420) * rect.width;
    const py = (d.y / 520) * rect.height;
    el.style.left = (px - 24) + 'px';
    el.style.top = (py - 24) + 'px';
    el.style.pointerEvents = 'auto';
    nodeLayer.appendChild(el);
    // add click handler
    el.addEventListener('click', ()=> onNodeClick(i, el));
  });
}
window.addEventListener('resize', placeNodes);
setTimeout(placeNodes, 300); // after layout

/* ========== Questions & logic ========== */
const questions = [
  {q:"Why you are so beautiful?", a1:"Because I smile", a2:"Because of you"},
  {q:"Apki aawaaz mujhe maar degi kisi din, gaogi 'Janemann' kya?", a1:"Yes", a2:"No"},
  {q:"Agar mai poochu: Momos ya Mujhe ‚Äî kisko chunogi?", a1:"Momos", a2:"Mujhe"},
  {q:"I know you are cute ‚Äî kya tum meri beti banogi ache wali?", a1:"Yes", a2:"No"}
];
let answeredCount = 0;
const modal = document.getElementById('modal');
const qtxt = document.getElementById('qtxt');
const optA = document.getElementById('optA');
const optB = document.getElementById('optB');

function showModalForQuestion(idx){
  qtxt.textContent = questions[idx].q;
  optA.textContent = questions[idx].a1;
  optB.textContent = questions[idx].a2;
  modal.style.display = 'block';
  // reset special classes
  optA.classList.remove('dodge'); optB.classList.remove('dodge');
  // special for question 3 (index 2): make Momos option dodge if chosen
  if(idx === 2){
    // make option A = Momos dodge behavior
    optA.onclick = ()=> {
      // animate dodge -> move position randomly
      dodgeButton(optA);
      showTinyToast("Momos naughty! Try choosing the other one üòú");
    };
    optB.onclick = ()=> {
      // choose 'Mujhe' => accept and proceed
      modal.style.display = 'none';
      answeredCount++;
      heartBurst(8);
      checkFinal();
    };
  } else if(idx === 0 || idx === 1){
    optA.onclick = ()=> { modal.style.display='none'; answeredCount++; heartBurst(6); checkFinal(); };
    optB.onclick = ()=> { modal.style.display='none'; answeredCount++; heartBurst(6); checkFinal(); };
  } else if(idx === 3){
    // final yes/no logic
    optA.onclick = ()=> { // Yes chosen
      modal.style.display='none';
      answeredCount++;
      heartBurst(12);
      triggerFinalReveal(true);
    };
    optB.onclick = ()=> { // No chosen
      modal.style.display='none';
      showTinyToast("Katti hu tumse ab me üò§");
      // show brief broken-heart animation
      showBrokenHeart();
    };
  }
}

/* dodge button playful effect */
function dodgeButton(btn){
  btn.style.transition = 'transform .12s ease, left .18s ease, top .18s ease';
  btn.classList.add('dodge');
  const r = 60 + Math.random()*120;
  const ang = Math.random() * Math.PI * 2;
  btn.style.transform = `translate(${Math.cos(ang)*r}px, ${Math.sin(ang)*r}px)`;
  setTimeout(()=> {
    btn.style.transform = '';
    btn.classList.remove('dodge');
  }, 540);
}

/* heart burst */
function heartBurst(n){
  for(let i=0;i<n;i++){
    const el = document.createElement('div');
    el.className = 'fheart';
    el.innerText = '‚ù§Ô∏è';
    const size = 14 + Math.random()*32;
    el.style.fontSize = size + 'px';
    el.style.left = (50 + (Math.random()*160-80)) + 'vw';
    el.style.top = (40 + Math.random()*30) + 'vh';
    el.style.opacity = 1;
    el.style.transition = `transform ${900+Math.random()*600}ms cubic-bezier(.2,.9,.2,1), opacity 900ms linear`;
    document.getElementById('fallingLayer').appendChild(el);
    requestAnimationFrame(()=> {
      el.style.transform = `translateY(${200 + Math.random()*260}px) translateX(${Math.random()*140-70}px) scale(${0.6+Math.random()*0.9}) rotate(${Math.random()*160-80}deg)`;
      el.style.opacity = 0;
    });
    setTimeout(()=> el.remove(), 2000);
  }
}

/* tiny toast messages */
function showTinyToast(txt){
  const t = document.createElement('div');
  t.textContent = txt;
  t.style.position='fixed'; t.style.left='50%'; t.style.bottom='8%'; t.style.transform='translateX(-50%)';
  t.style.background='linear-gradient(90deg,var(--accent),#ff8aa0)'; t.style.padding='8px 12px'; t.style.borderRadius='12px'; t.style.zIndex=90; t.style.boxShadow='0 10px 30px rgba(0,0,0,0.5)';
  document.body.appendChild(t);
  setTimeout(()=> { t.style.transition='opacity .5s'; t.style.opacity=0; setTimeout(()=> t.remove(),600)},1600);
}

/* broken heart */
function showBrokenHeart(){
  const el = document.createElement('div');
  el.textContent = 'üíî';
  el.style.position='fixed'; el.style.left='50%'; el.style.top='20%'; el.style.transform='translateX(-50%)'; el.style.fontSize='72px'; el.style.zIndex=90;
  document.body.appendChild(el);
  setTimeout(()=> el.remove(),1800);
}

/* ========== node click handler ========== */
function onNodeClick(index, element){
  // disable pointer until modal closed
  element.style.pointerEvents = 'none';
  // ask the question corresponding to index order (we ensure order by tracking answeredCount)
  const qIndex = answeredCount; // show sequentially
  if(qIndex >= questions.length) return;
  showModalForQuestion(qIndex);
}

/* check after each answer if need to continue or finish */
function checkFinal(){
  if(answeredCount >= questions.length - 1){
    // last question remains; but this function is called after intermediate Qs
    // we simply let user click next heart and trigger final flow
    // small hint
    showTinyToast("Almost there... click the last heart!");
  }
}

/* final reveal: burning animation then reveal panel */
const burnOverlay = document.getElementById('burnOverlay');
const reveal = document.getElementById('reveal');
function triggerFinalReveal(ok){
  if(!ok) return;
  burnOverlay.style.display = 'flex';
  setTimeout(()=> {
    burnOverlay.style.display = 'none';
    reveal.style.display = 'flex';
    // animate reveal elements
    const big = document.querySelector('.big');
    big.style.transform = 'scale(.92)';
    setTimeout(()=> big.style.transform = 'scale(1)', 60);
    // float some I‚ù§Ô∏èU bubbles
    spawnFloaters();
    try { audio.currentTime = 0; audio.play().catch(()=>{}); } catch(e){}
  }, 2200);
}

/* floaters (I ‚ù§Ô∏è U) */
const floaters = document.getElementById('floaters');
function spawnFloaters(){
  for(let i=0;i<10;i++){
    const f = document.createElement('div');
    f.className = 'floater';
    f.style.left = (10 + Math.random()*80) + 'vw';
    f.style.bottom = (5 + Math.random()*40) + 'vh';
    f.style.fontSize = (12 + Math.random()*28) + 'px';
    f.textContent = 'I ‚ù§Ô∏è U';
    floaters.appendChild(f);
    const dur = 6000 + Math.random()*6000;
    f.style.animationDuration = dur + 'ms';
    setTimeout(()=> f.remove(), dur+200);
  }
}

/* ========== Start button wiring & hint to click heart nodes only after tree drawn ========== */
document.getElementById('playBtn').addEventListener('click', ()=>{
  try{ audio.play().catch(()=>{}); }catch(e){}
  // show hint toast
  showTinyToast("Tap a heart on the tree to answer!");
});

// ensure nodes are active only once drawing finished (draw animation length ~2.6s)
setTimeout(()=> {
  // nodes place again (just in case)
  placeNodes();
  // enable nodes (they already added click handlers)
}, 2800);

/* ========== small accessibility: clicking outside modal does nothing (force pick) ========== */
/* Hide modal when not used by flow - we rely on explicit picks so not auto-close */

/* ========== final: create nodes initially (in case placeNodes not yet run) ========== */
setTimeout(()=> {
  placeNodes();
  // add gentle pulse and hint
  document.querySelectorAll('.node').forEach((n, i)=>{
    setTimeout(()=> n.classList.add('pulse'), 600 + i*120);
  });
}, 600);

/* ========== initial tiny star twinkle and first spawn ========== */
setTimeout(()=> spawnFloatingHeart(), 1000);

</script>
</body>
</html>
